https://www.baeldung.com/java-string-pool

자바 7 이전에는 JVM이 문자열 풀을 PermGen 영역에 저장했습니다. PermGen 영역은 크기가 고정되어 있어서 실행 중에 늘리거나 가비지 컬렉션 대상이 아닙니다. 따라서 너무 많은 문자열을 인터닝하면 JVM에서 OutOfMemory 오류가 발생할 수 있습니다.

하지만 Java 7부터는 문자열 풀을 Heap 영역에 저장하게 되었습니다. 이 방식의 장점은 참조되지 않는 문자열이 풀에서 제거되어 메모리가 해제된다는 것입니다. 그래서 OutOfMemory 오류 발생 가능성이 줄어듭니다.

성능 최적화 측면에서 Java 6에서는 PermGen 영역 크기를 프로그램 실행 중에 MaxPermSize JVM 옵션을 통해 증가시키는 것이 유일한 최적화 방법이었습니다. 그러나 Java 7부터는 더 많은 옵션을 사용하여 문자열 풀의 크기를 조사하고 조절할 수 있습니다. 풀 크기를 확인하는 두 가지 옵션이 있습니다:

- -XX:+PrintFlagsFinal
- -XX:+PrintStringTableStatistics

풀 크기를 버킷 단위로 늘리려면 StringTableSize JVM 옵션을 사용할 수 있습니다. 초기 기본 풀 크기는 Java 7u40 이전에는 1009 버킷이었지만, 이후 버전에서 변경되었습니다. 현재 기본 풀 크기는 65536입니다. 풀 크기를 늘리면 더 많은 메모리를 사용하지만 문자열을 테이블에 삽입하는 데 필요한 시간이 줄어듭니다.

마지막으로, Java 9에는 중요한 변경 사항이 있습니다. Java 8까지는 문자열이 UTF-16으로 인코딩된 문자 배열(char[])로 표현되었습니다. 그러나 Java 9에서는 Compact Strings라는 새로운 표현 방식이 도입되어 문자열의 내용에 따라 적절한 인코딩을 선택합니다. 이로 인해 힙 메모리 사용량이 크게 감소하고, 따라서 JVM에서의 Garbage Collector 오버헤드가 줄어듭니다.